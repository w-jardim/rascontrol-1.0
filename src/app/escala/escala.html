<div class="dashboard-container">
  <app-sidebar></app-sidebar>

  <!-- Header Sticky -->
  <header class="sticky-header">
    <div class="header-content">
      <h1>Escala de Serviços</h1>
      <p>Gerenciamento completo dos serviços RAS registrados</p>
    </div>
  </header>

  <main class="main-content">
    <div class="escala-container">
      <div class="escala-content">
        <div class='servicos-list' *ngIf='servicos.length > 0; else noServicos'>
          <!-- Header da tabela -->
          <div class='servicos-table-header'>
            <div class='table-row'>
              <div class='table-cell header-cell'>Serviço</div>
              <div class='table-cell header-cell'>Convênio</div>
              <div class='table-cell header-cell'>Evento</div>
              <div class='table-cell header-cell'>Data</div>
              <div class='table-cell header-cell'>Hora</div>
              <div class='table-cell header-cell'>Valor</div>
              <div class='table-cell header-cell'>Ações</div>
            </div>
          </div>

          <!-- Corpo da tabela -->
          <div class='servicos-table-body'>
            <div class='table-row' *ngFor='let servico of servicos; let i = index'>
              <div class='table-cell'>{{ i + 1 }}</div>
              <div class='table-cell'>{{ servico.convenio | titlecase }}</div>
              <div class='table-cell'>{{ servico.evento | titlecase }}</div>
              <div class='table-cell'>{{ servico.data | date:'dd/MM/yyyy' }}</div>
              <div class='table-cell'>{{ servico.hora }}</div>
              <div class='table-cell'>R$ {{ servico.valor | number:'1.2-2' }}</div>
              <div class='table-cell actions-cell'>
                <button class='btn-edit' (click)='startEdit(i)' *ngIf='editingIndex !== i'>
                  <ng-icon name="lucideEdit" class='btn-icon'></ng-icon>
                </button>
                <button class='btn-delete' (click)='deleteServico(i)'>
                  <ng-icon name="lucideTrash" class='btn-icon'></ng-icon>
                </button>
              </div>
            </div>
          </div>

          <!-- Formulário de edição inline -->
          <div class='servico-edit' *ngIf='editingIndex !== null'>
            <form [formGroup]='editForm' (ngSubmit)='saveEdit()' class='edit-form'>
              <div class='form-grid'>
                <div class='form-group'>
                  <label for='convenio'>Convênio *</label>
                  <select id='convenio' formControlName='convenio' class='form-control'>
                    <option value=''>Selecione</option>
                    <option value='ras'>RAS</option>
                    <option value='proeis'>PROEIS</option>
                  </select>
                </div>
                <div class='form-group'>
                  <label for='evento'>Evento *</label>
                  <select id='evento' formControlName='evento' class='form-control'>
                    <option value=''>Selecione</option>
                    <option value='voluntario'>Voluntário</option>
                    <option value='compulsorio'>Compulsório</option>
                  </select>
                </div>
                <div class='form-group'>
                  <label for='data'>Data *</label>
                  <input type='date' id='data' formControlName='data' class='form-control'>
                </div>
                <div class='form-group'>
                  <label for='hora'>Hora *</label>
                  <input type='time' id='hora' formControlName='hora' class='form-control'>
                </div>
                <div class='form-group'>
                  <label for='tipoVaga'>Tipo de Vaga *</label>
                  <select id='tipoVaga' formControlName='tipoVaga' class='form-control'>
                    <option value=''>Selecione</option>
                    <option value='reserva'>Reserva</option>
                    <option value='titular'>Titular</option>
                  </select>
                </div>
                <div class='form-group'>
                  <label for='tipoHora'>Tipo de Hora *</label>
                  <select id='tipoHora' formControlName='tipoHora' class='form-control'>
                    <option value=''>Selecione</option>
                    <option value='6h'>6 horas</option>
                    <option value='8h'>8 horas</option>
                    <option value='12h'>12 horas</option>
                    <option value='24h'>24 horas</option>
                  </select>
                </div>
                <div class='form-group'>
                  <label for='valor'>Valor *</label>
                  <input type='number' id='valor' formControlName='valor' class='form-control' step='0.01'>
                </div>
                <div class='form-group form-group-full'>
                  <label>Benefícios</label>
                  <div class='checkbox-group'>
                    <label class='checkbox-label'>
                      <input type='checkbox' formControlName='transporte'>
                      Transporte
                    </label>
                    <label class='checkbox-label'>
                      <input type='checkbox' formControlName='alimentacao'>
                      Alimentação
                    </label>
                  </div>
                </div>
              </div>
              <div class='edit-actions'>
                <button type='submit' class='btn-save' [disabled]='!editForm.valid'>
                  <ng-icon name="lucideSave" class='btn-icon'></ng-icon>
                  Salvar
                </button>
                <button type='button' class='btn-cancel' (click)='cancelEdit()'>
                  <ng-icon name="lucideX" class='btn-icon'></ng-icon>
                  Cancelar
                </button>
              </div>
            </form>
          </div>
        </div>

        <ng-template #noServicos>
          <div class='no-servicos'>
            <ng-icon name="lucideFileX" class='no-icon'></ng-icon>
            <h3>Nenhum serviço registrado</h3>
            <p>Crie um serviço RAS primeiro para visualizá-lo aqui.</p>
          </div>
        </ng-template>
      </div>
    </div>
  </main>
</div>
